<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çœ¼é•œåº“</title>
    <style>
        :root {
            --primary-color: #00796b;
            --secondary-color: #4a5568;
            --background-color: #f4f5f7;
            --card-bg-color: #ffffff;
            --border-color: #e2e8f0;
            --danger-color: #e53e3e;
            --info-color: #3b82f6;
            --warning-color: #f59e0b;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--secondary-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 960px;
            margin: 0 auto;
        }
        /* 1. è¿”å›æŒ‰é’®æ ·å¼ (å‚è€ƒ cost.html) */
        .header-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            margin-bottom: 25px;
            background-color: var(--card-bg-color);
            padding: 20px 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        .header-nav h1 {
            margin: 0;
            color: var(--primary-color);
            font-size: 1.8em;
        }
        .header-actions {
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
        }
        .card {
            background-color: var(--card-bg-color);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        h2 {
            color: var(--primary-color);
            text-align: center;
            margin-top: 0;
            margin-bottom: 25px;
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        .full-width { grid-column: 1 / -1; }
        label {
            margin-bottom: 5px;
            font-size: 0.9em;
            color: #6b7280;
            font-weight: 600;
        }
        input, select, textarea {
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 1em;
            width: 100%;
            box-sizing: border-box;
            background-color: #f8fafc;
        }
        textarea { resize: vertical; min-height: 80px; }
        fieldset {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin: 0;
            grid-column: 1 / -1;
        }
        legend {
            padding: 0 10px;
            font-weight: 600;
            color: var(--primary-color);
        }
        .eye-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        .button-group {
            grid-column: 1 / -1;
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .btn, button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            text-decoration: none;
            text-align: center;
            white-space: nowrap;
        }
        .btn-primary { background-color: var(--primary-color); color: white; }
        .btn-primary:hover { background-color: #00695c; }
        .btn-secondary { background-color: #6b7280; color: white; }
        .btn-secondary:hover { background-color: #4a5568; }
        .button-group button { flex-grow: 1; }

        .actions-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .glasses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .glass-card {
            background-color: #fdfdff;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        .glass-card h3 {
            margin-top: 0;
            color: var(--primary-color);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        .glass-card p { margin: 5px 0; font-size: 0.95em; }
        .glass-card strong { color: var(--secondary-color); }
        .card-actions {
            margin-top: auto;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        .card-actions .btn { padding: 6px 12px; font-size: 0.9em; }
        .btn-details { background-color: var(--info-color); color: white; }
        .btn-edit { background-color: var(--warning-color); color: white; }
        .btn-delete { background-color: var(--danger-color); color: white; }
        .btn-export { background-color: #1d4ed8; color: white; }

        /* 7. è¯¦æƒ…å¼¹çª—æ ·å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s;
        }
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #9ca3af;
        }
        .modal-content h3 { color: var(--primary-color); margin-top: 0; }
        .details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px 20px;
        }
        .details-grid p { margin: 5px 0; }

        @media (max-width: 768px) {
            body { padding: 10px; }
            .header-nav {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }
            .header-nav h1 { text-align: center; }
            .header-actions {
                position: static;
                transform: none;
                width: 100%;
                display: flex;
            }
            .header-actions .btn { flex-grow: 1; }
            .form-grid, .eye-grid, .details-grid {
                grid-template-columns: 1fr;
            }
            .modal-content { padding: 20px; }
            .modal-close { top: 10px; right: 10px; }
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- 1, 5. æ›´æ–°æ ‡é¢˜å’Œè¿”å›æŒ‰é’® -->
        <div class="header-nav">
            <h1>çœ¼é•œåº“ ğŸ¤“</h1>
            <div class="header-actions">
                <a href="https://maggiec87.github.io/vision-kits/" class="btn btn-secondary">è¿”å›</a>
            </div>
        </div>

        <div class="card">
            <h2 id="form-title">æ·»åŠ </h2>
            <form id="glass-form">
                <input type="hidden" id="edit-index">
                <div class="form-grid">
                    <!-- 4. ä½¿ç”¨è€…æ”¹ä¸ºåå­—, å¢åŠ å¹´é¾„ -->
                    <div class="form-group">
                        <label for="glass-name">åå­—</label>
                        <input type="text" id="glass-name" placeholder="å¦‚ï¼šå°æ˜" required>
                    </div>
                    <div class="form-group">
                        <label for="glass-age">å¹´é¾„</label>
                        <input type="text" id="glass-age" placeholder="å¦‚ï¼šé…é•œæ—¶8å²">
                    </div>
                    <div class="form-group">
                        <label for="glass-type">ç±»å‹</label>
                        <input type="text" id="glass-type" placeholder="å¦‚ï¼šæ˜Ÿè¶£æ§ã€æ§ä¼˜ç‚¹ã€æŸ¯å­¦ä¼˜">

                    </div>
                    <!-- 3. å¢åŠ è´­ä¹°åº—é“ºã€æ—¶é—´ã€ä»·æ ¼ -->
                    <div class="form-group">
                        <label for="purchase-date">é…é•œæ—¥æœŸ</label>
                        <input type="date" id="purchase-date" required>
                    </div>
                    <div class="form-group">
                        <label for="wear-date">æˆ´é•œæ—¥æœŸ</label>
                        <input type="date" id="wear-date" required>
                    </div>
                    <div class="form-group">
                        <label for="purchase-store">è´­ä¹°åº—</label>
                        <input type="text" id="purchase-store" placeholder="å¦‚ï¼šåšå£«çœ¼é•œ">
                    </div>
                    <div class="form-group">
                        <label for="purchase-price">ä»·æ ¼ (å…ƒ)</label>
                        <input type="number" id="purchase-price" placeholder="å¦‚ï¼š1280" step="0.01">
                    </div>

                    <!-- 2. é€‰æ‹©å·¦å³çœ¼çš„å±ˆå…‰å’Œæ•£å…‰åº¦æ•° -->
                    <fieldset>
                        <legend>å³çœ¼ (OD)</legend>
                        <div class="eye-grid">
                            <div class="form-group">
                                <label for="od-sph">çƒé•œ (SPH)</label>
                                <select id="od-sph"></select>
                            </div>
                            <div class="form-group">
                                <label for="od-cyl">æŸ±é•œ (CYL)</label>
                                <select id="od-cyl"></select>
                            </div>
                            <div class="form-group">
                                <label for="od-ax">è½´ä½ (AX)</label>
                                <input type="number" id="od-ax" min="0" max="180" step="1" placeholder="0-180">
                            </div>
                        </div>
                    </fieldset>
                    <fieldset>
                        <legend>å·¦çœ¼ (OS)</legend>
                        <div class="eye-grid">
                            <div class="form-group">
                                <label for="os-sph">çƒé•œ (SPH)</label>
                                <select id="os-sph"></select>
                            </div>
                            <div class="form-group">
                                <label for="os-cyl">æŸ±é•œ (CYL)</label>
                                <select id="os-cyl"></select>
                            </div>
                            <div class="form-group">
                                <label for="os-ax">è½´ä½ (AX)</label>
                                <input type="number" id="os-ax" min="0" max="180" step="1" placeholder="0-180">
                            </div>
                        </div>
                    </fieldset>
                    
                    <div class="form-group full-width">
                        <label for="glass-notes">å¤‡æ³¨</label>
                        <textarea id="glass-notes" placeholder="å¦‚ï¼šè”¡å¸é’»ç«‹æ–¹é“‚é‡‘è†œï¼Œé•œæ¡†å“ç‰Œå‹å·ç­‰"></textarea>
                    </div>
                </div>
                <div class="button-group">
                    <button type="submit" id="submit-btn" class="btn-primary">æ·»åŠ </button>
                    <button type="button" id="cancel-edit-btn" class="btn-secondary" style="display: none;">å–æ¶ˆä¿®æ”¹</button>
                </div>
            </form>
        </div>

        <div class="card">
            <div class="actions-header">
                <h2>çœ¼é•œä»¬</h2>
                <!-- 6. å¢åŠ å¯¼å‡º -->
                <button id="export-csv-btn" class="btn btn-export">å¯¼å‡º</button>
            </div>
            <div id="glasses-list" class="glasses-grid">
                <!-- Glasses cards will be inserted here -->
            </div>
        </div>
    </div>

    <!-- 7. è¯¦æƒ…å¼¹çª— -->
    <div id="details-modal" class="modal-overlay">
        <div class="modal-content">
            <button id="modal-close-btn" class="modal-close">&times;</button>
            <div id="modal-body">
                <!-- Details will be injected here -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // è¡¨å•å…ƒç´ 
            const glassForm = document.getElementById('glass-form');
            const formTitle = document.getElementById('form-title');
            const submitBtn = document.getElementById('submit-btn');
            const cancelEditBtn = document.getElementById('cancel-edit-btn');
            const editIndexInput = document.getElementById('edit-index');

            // åˆ—è¡¨å’Œå¯¼å‡º
            const glassesList = document.getElementById('glasses-list');
            const exportCsvBtn = document.getElementById('export-csv-btn');
            
            // å¼¹çª—å…ƒç´ 
            const detailsModal = document.getElementById('details-modal');
            const modalCloseBtn = document.getElementById('modal-close-btn');
            const modalBody = document.getElementById('modal-body');

            // åŠ¨æ€ç”Ÿæˆåº¦æ•°é€‰é¡¹
            function populateDegreeOptions(selectElement, start, end, step, type) {
                selectElement.innerHTML = '';
                for (let i = start; i <= end; i += step) {
                    const value = i.toFixed(2);
                    const option = document.createElement('option');
                    option.value = value;
                    option.textContent = (i > 0 && type === 'sph' ? '+' : '') + value;
                    selectElement.appendChild(option);
                }
                selectElement.value = "0.00"; // é»˜è®¤å€¼
            }

            populateDegreeOptions(document.getElementById('od-sph'), -12.00, 6.00, 0.25, 'sph');
            populateDegreeOptions(document.getElementById('os-sph'), -12.00, 6.00, 0.25, 'sph');
            populateDegreeOptions(document.getElementById('od-cyl'), -6.00, 0.00, 0.25, 'cyl');
            populateDegreeOptions(document.getElementById('os-cyl'), -6.00, 0.00, 0.25, 'cyl');

            let glasses = JSON.parse(localStorage.getItem('myGlasses')) || [];

            const saveGlasses = () => {
                localStorage.setItem('myGlasses', JSON.stringify(glasses));
            };

            const renderGlasses = () => {
                glassesList.innerHTML = '';
                if (glasses.length === 0) {
                    glassesList.innerHTML = '<p style="grid-column: 1 / -1; text-align: center;">è¿˜æ²¡æœ‰çœ¼é•œè®°å½•ï¼Œå¿«æ·»åŠ ä¸€å‰¯å§ï¼</p>';
                    return;
                }
                
                // â–¼â–¼â–¼ ä¿®æ”¹ï¼šæŒ‰é…é•œæ—¥æœŸæ’åº â–¼â–¼â–¼
                const sortedGlasses = [...glasses].sort((a,b) => new Date(b.date) - new Date(a.date));

                sortedGlasses.forEach((glass) => {
                    const originalIndex = glasses.findIndex(g => g.id === glass.id);
                    const card = document.createElement('div');
                    card.className = 'glass-card';
                    
                    const odStr = `R: ${glass.od_sph} / ${glass.od_cyl} x ${glass.od_ax || ''}`;
                    const osStr = `L: ${glass.os_sph} / ${glass.os_cyl} x ${glass.os_ax || ''}`;

                    card.innerHTML = `
                        <h3>${glass.name}çš„${glass.type}</h3>
                        <p><strong>å¹´é¾„:</strong> ${glass.age || 'æœªå¡«å†™'}</p>
                        <p><strong>é…é•œæ—¥æœŸ:</strong> ${glass.date || 'æœªå¡«å†™'}</p>
                        <p><strong>åº¦æ•°:</strong> ${odStr} | ${osStr}</p>
                        <p><strong>ä»·æ ¼:</strong> ${glass.price ? `Â¥${parseFloat(glass.price).toFixed(2)}` : 'æœªå¡«å†™'}</p>
                        <div class="card-actions">
                            <button class="btn btn-details" data-index="${originalIndex}">è¯¦æƒ…</button>
                            <button class="btn btn-edit" data-index="${originalIndex}">ä¿®æ”¹</button>
                            <button class="btn btn-delete" data-index="${originalIndex}">åˆ é™¤</button>
                        </div>
                    `;
                    glassesList.appendChild(card);
                });
            };

            const resetForm = () => {
                glassForm.reset();
                document.getElementById('od-sph').value = "0.00";
                document.getElementById('os-sph').value = "0.00";
                document.getElementById('od-cyl').value = "0.00";
                document.getElementById('os-cyl').value = "0.00";
                editIndexInput.value = '';
                formTitle.textContent = 'æ·»åŠ ';
                submitBtn.textContent = 'æ·»åŠ ';
                cancelEditBtn.style.display = 'none';
            };

            glassForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                // â–¼â–¼â–¼ ä¿®æ”¹/æ–°å¢ï¼šå¢åŠ è¯»å– wearDate â–¼â–¼â–¼
                const glassData = {
                    name: document.getElementById('glass-name').value.trim(),
                    age: document.getElementById('glass-age').value.trim(),
                    type: document.getElementById('glass-type').value,
                    date: document.getElementById('purchase-date').value, // é…é•œæ—¥æœŸ
                    wearDate: document.getElementById('wear-date').value,  // æˆ´é•œæ—¥æœŸ
                    store: document.getElementById('purchase-store').value.trim(),
                    price: document.getElementById('purchase-price').value,
                    od_sph: document.getElementById('od-sph').value,
                    od_cyl: document.getElementById('od-cyl').value,
                    od_ax: document.getElementById('od-ax').value,
                    os_sph: document.getElementById('os-sph').value,
                    os_cyl: document.getElementById('os-cyl').value,
                    os_ax: document.getElementById('os-ax').value,
                    notes: document.getElementById('glass-notes').value.trim(),
                };

                const editIndex = editIndexInput.value;

                if (editIndex !== '') {
                    // æ›´æ–°æ¨¡å¼
                    glasses[editIndex] = { ...glasses[editIndex], ...glassData };
                } else {
                    // æ–°å¢æ¨¡å¼
                    glassData.id = Date.now(); // ä¸ºæ¯æ¡è®°å½•æ·»åŠ å”¯ä¸€ID
                    glasses.push(glassData);
                }

                saveGlasses();
                renderGlasses();
                resetForm();
            });

            cancelEditBtn.addEventListener('click', resetForm);
            
            glassesList.addEventListener('click', (e) => {
                const button = e.target.closest('button');
                if (!button || !button.dataset.index) return;

                const index = parseInt(button.dataset.index, 10);
                const glass = glasses[index];

                if (button.classList.contains('btn-delete')) {
                    if (confirm(`ç¡®å®šè¦åˆ é™¤ã€${glass.name}çš„${glass.type}ã€‘è¿™æ¡è®°å½•å—ï¼Ÿ`)) {
                        glasses.splice(index, 1);
                        saveGlasses();
                        renderGlasses();
                    }
                } else if (button.classList.contains('btn-edit')) {
                    formTitle.textContent = 'ä¿®æ”¹çœ¼é•œä¿¡æ¯';
                    submitBtn.textContent = 'æ›´æ–°è®°å½•';
                    cancelEditBtn.style.display = 'inline-block';
                    editIndexInput.value = index;

                    document.getElementById('glass-name').value = glass.name;
                    document.getElementById('glass-age').value = glass.age;
                    document.getElementById('glass-type').value = glass.type;
                    document.getElementById('purchase-date').value = glass.date;
                    document.getElementById('wear-date').value = glass.wearDate; // â–¼â–¼â–¼ æ–°å¢ï¼šå¡«å……æˆ´é•œæ—¥æœŸ â–¼â–¼â–¼
                    document.getElementById('purchase-store').value = glass.store;
                    document.getElementById('purchase-price').value = glass.price;
                    document.getElementById('od-sph').value = glass.od_sph;
                    document.getElementById('od-cyl').value = glass.od_cyl;
                    document.getElementById('od-ax').value = glass.od_ax;
                    document.getElementById('os-sph').value = glass.os_sph;
                    document.getElementById('os-cyl').value = glass.os_cyl;
                    document.getElementById('os-ax').value = glass.os_ax;
                    document.getElementById('glass-notes').value = glass.notes;

                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else if (button.classList.contains('btn-details')) {
                    showDetailsModal(glass);
                }
            });

            function showDetailsModal(glass) {
                // â–¼â–¼â–¼ ä¿®æ”¹ï¼šåœ¨è¯¦æƒ…ä¸­å¢åŠ æˆ´é•œæ—¥æœŸ â–¼â–¼â–¼
                modalBody.innerHTML = `
                    <h3>${glass.name}çš„${glass.type}</h3>
                    <div class="details-grid">
                        <p><strong>åå­—:</strong> ${glass.name}</p>
                        <p><strong>å¹´é¾„:</strong> ${glass.age || 'N/A'}</p>
                        <p><strong>é…é•œæ—¥æœŸ:</strong> ${glass.date || 'N/A'}</p>
                        <p><strong>æˆ´é•œæ—¥æœŸ:</strong> ${glass.wearDate || 'N/A'}</p>
                        <p><strong>è´­ä¹°åº—é“º:</strong> ${glass.store || 'N/A'}</p>
                        <p><strong>ä»·æ ¼:</strong> ${glass.price ? `Â¥${parseFloat(glass.price).toFixed(2)}` : 'N/A'}</p>
                    </div>
                    <hr style="border:0; border-top: 1px solid var(--border-color); margin: 15px 0;">
                    <div class="details-grid">
                        <div>
                            <h4>å³çœ¼ (OD)</h4>
                            <p><strong>çƒé•œ:</strong> ${glass.od_sph}</p>
                            <p><strong>æŸ±é•œ:</strong> ${glass.od_cyl}</p>
                            <p><strong>è½´ä½:</strong> ${glass.od_ax || 'N/A'}</p>
                        </div>
                        <div>
                            <h4>å·¦çœ¼ (OS)</h4>
                            <p><strong>çƒé•œ:</strong> ${glass.os_sph}</p>
                            <p><strong>æŸ±é•œ:</strong> ${glass.os_cyl}</p>
                            <p><strong>è½´ä½:</strong> ${glass.os_ax || 'N/A'}</p>
                        </div>
                    </div>
                    <hr style="border:0; border-top: 1px solid var(--border-color); margin: 15px 0;">
                    <h4>å¤‡æ³¨</h4>
                    <p>${glass.notes ? glass.notes.replace(/\n/g, '<br>') : 'æ— '}</p>
                `;
                detailsModal.classList.add('visible');
            }

            function hideDetailsModal() {
                detailsModal.classList.remove('visible');
            }

            modalCloseBtn.addEventListener('click', hideDetailsModal);
            detailsModal.addEventListener('click', (e) => {
                if (e.target === detailsModal) {
                    hideDetailsModal();
                }
            });

            exportCsvBtn.addEventListener('click', () => {
                if (glasses.length === 0) {
                    alert('æ²¡æœ‰æ•°æ®å¯ä»¥å¯¼å‡ºã€‚');
                    return;
                }

                // â–¼â–¼â–¼ ä¿®æ”¹ï¼šå¢åŠ â€œæˆ´é•œæ—¥æœŸâ€åˆ°è¡¨å¤´ â–¼â–¼â–¼
                const headers = [
                    'åå­—', 'å¹´é¾„', 'ç±»å‹', 'é…é•œæ—¥æœŸ', 'æˆ´é•œæ—¥æœŸ', 'è´­ä¹°åº—é“º', 'ä»·æ ¼',
                    'å³çœ¼çƒé•œ(SPH)', 'å³çœ¼æŸ±é•œ(CYL)', 'å³çœ¼è½´ä½(AX)',
                    'å·¦çœ¼çƒé•œ(SPH)', 'å·¦çœ¼æŸ±é•œ(CYL)', 'å·¦çœ¼è½´ä½(AX)', 'å¤‡æ³¨'
                ];
                
                let csvContent = "\uFEFF" + headers.join(',') + '\n';

                const sortedForExport = [...glasses].sort((a,b) => new Date(a.date) - new Date(b.date));

                sortedForExport.forEach(g => {
                    // â–¼â–¼â–¼ ä¿®æ”¹ï¼šå¢åŠ  g.wearDate åˆ°å¯¼å‡ºçš„è¡Œæ•°æ®ä¸­ â–¼â–¼â–¼
                    const row = [
                        g.name, g.age, g.type, g.date, g.wearDate, g.store, g.price,
                        g.od_sph, g.od_cyl, g.od_ax,
                        g.os_sph, g.os_cyl, g.os_ax,
                        `"${(g.notes || '').replace(/"/g, '""')}"` // å¤„ç†å¤‡æ³¨ä¸­çš„é€—å·å’Œå¼•å·
                    ];
                    csvContent += row.join(',') + '\n';
                });

                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement("a");
                const url = URL.createObjectURL(blob);
                link.setAttribute("href", url);
                const timestamp = new Date().toISOString().slice(0, 10);
                link.setAttribute("download", `çœ¼é•œåº“_${timestamp}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });

            // åˆå§‹åŒ–
            renderGlasses();
        });
    </script>

</body>

</html>
